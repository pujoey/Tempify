<navbar></navbar>


<!-- hide once weather data is received -->
<div ng-hide="vm.weatherUpdated" class='animate-leave'>
  <header class="hero-unit" id="banner">
    <div class="container">
      <br>
      <br>
      <h1>CONNECTING TO YOUR NEST...</h1>
      <br>
      <br>
      <br>
      <img src="assets/images/nest-home.png" style="width:380px;height:380px;" alt="Nest">
    </div>
  </header>

</div>

<!-- stay hidden until weather data is received -->
<div ng-show="vm.weatherUpdated" class='animate-enter'>

  <div ng-repeat="s in vm.structures">
    <div class="row">

      <!-- NEST API to show HOME/AWAY status -->
      <div class="col-sm-4 col-md-4">
        <div class="thumbnail">
          <div class="caption">
          <br>
          <br>
          <h1><span class="glyphicon glyphicon-home" style="color:#80d5ff;" aria-hidden="true"></span></h1>
          <h1>{{ s.name }}</h1>
          <h3>HOME/AWAY: {{ s.away }}</h3>
          <br>
          <br>
          <br>
          </div>
        </div>
      </div>

      <!-- Yahoo weather API for current temp -->
      <div class="col-sm-4 col-md-4">
        <div class="thumbnail">
          <br>
          <a href="{{vm.weather.link}}">
          <img border="0" alt="yahoo!weather" src="{{vm.weather.image.url}}" width="142" height="18">
          </a>
          <div class="caption">
            <h3>Outside: {{vm.weather.item.condition.temp}}℉ {{vm.weather.item.condition.text}}</h3>
            <ul  class="list-group">
              <li class="list-group-item" >Wind Chill <strong>{{vm.weather.wind.chill}} mph</strong></li>
              <li class="list-group-item" >Humidity <strong>{{vm.weather.atmosphere.humidity}}%</strong></li>
              <li class="list-group-item" >Atmosphere Pressure <strong>{{vm.weather.atmosphere.pressure}}</strong></li>
              <li class="list-group-item" >Sunrise <strong>{{vm.weather.astronomy.sunrise}}</strong> | Sunset <strong>{{vm.weather.astronomy.sunset}}</strong></li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Yahoo weather API for 5 Day Forecasts -->
      <div class="col-sm-4 col-md-4">
        <div class="thumbnail">
          <div class="caption">
          <h3>5 DAY FORECASTS</h3>
          <ul class="list-group">
            <li class="list-group-item text-left" ng-repeat="day in vm.weather.item.forecast"><strong>{{day.day}}</strong> | High {{day.high}}℉ | Low {{day.low}}℉ | <strong>{{day.text}}</strong> </li>
          </ul>
          </div>
        </div>
      </div>

    </div>

    <br>
    <br>

    <div class="row">
      <div class="col-sm-4 col-md-4" ng-repeat="t in s.thermostats">
        <div class="thumbnail">
          <div class="caption">
            <h3>{{ t.name_long }}</h3>
            <ul class="list-group">
              <li class="list-group-item" ng-if="t.temperature_scale =='F' ">Current Temp <strong>{{ t.ambient_temperature_f }} ℉</strong></li>
              <li class="list-group-item" ng-if="t.temperature_scale =='C' ">Current Temp <strong>{{ t.ambient_temperature_c }} ℃</strong></li>
              <li class="list-group-item">Humidity <strong>{{ t.humidity }} %</strong></li>
              <li class="list-group-item" ng-if="t.temperature_scale =='F' ">Target Temp <strong>{{ t.target_temperature_f }} ℉</strong></li>
              <li class="list-group-item" ng-if="t.temperature_scale =='C' ">Target Temp <strong>{{ t.target_temperature_c }} ℃</strong></li>
            </ul>
              <form ng-submit="vm.updateThermo(t.device_id, t.newTemp)">
                <input placeholder="Set New Temperature..." ng-if="t.temperature_scale =='F'" ng-model="t.newTemp" ng-pattern="/^\d+$/" name="anim" class="my-input"
                         aria-describedby="inputDescription" />
                <input placeholder="Set New Temperature..." ng-if="t.temperature_scale =='C'" ng-model="t.newTemp" ng-pattern="/^\d+$/" name="anim" class="my-input"
                         aria-describedby="inputDescription" />
                <p ng-if="t.temperature_scale =='C' ">Target Temp: {{ t.target_temperature_c }} ℃</p>
                <input class="btn btn-primary" type="submit" id="submit" value="Submit" />
              </form>

          </div>
        </div>
      </div>
    </div>
  </div>

</div>


<!-- {{vm.response}} -->
<footer></footer>



<!-- Template for rendering Nest Thermostat state -->
<script id="thermTemplate" type="text/x-jsrender">
  <div class="mdl-cell mdl-cell--4-col">
    <div class="mdl-card mdl-shadow--2dp demo-card-square">
      <div class="mdl-card__title mdl-card--expand">
        <h2 class="mdl-card__title-text">{{:name_long}}</h2>
      </div>
      <div class="mdl-card__supporting-text">
        <span>
          <b>Temperature:</b>
          {{if temperature_scale === 'C'}}
            {{:target_temperature_c}}&deg;C
          {{else temperature_scale === 'F'}}
            {{:target_temperature_f}}&deg;F
          {{/if}}
        </span>
        <span>&bull;</span>
        <b>Humidity:</b> {{:humidity}}%
        {{if has_leaf}}
          <span>
            &bull;
          </span>
          <img src="/img/nest-leaf.png" class="leaf-img">
        {{/if}}
        {{if has_fan}}
          <span>&bull;</span>
          {{if fan_timer_active}}
            <b>Fan:</b> On ending on {{timeout:fan_timer_timeout}}
          {{else}}
            <b>Fan:</b> Off
          {{/if}}
        {{/if}}
      </div>
    </div>
  </div>
</script>

<!-- Template for rendering Nest Protect state -->
<script id="smokeTemplate" type="text/x-jsrender">
  <div class="mdl-cell mdl-cell--4-col">
    <div class="mdl-card mdl-shadow--2dp demo-card-square">
      <div class="mdl-card__title mdl-card--expand">
        <h2 class="mdl-card__title-text">{{:name_long}}</h2>
      </div>
      <div class="mdl-card__supporting-text">
        <span>
          <b>Battery Health:</b> {{:battery_health}}
        </span>
        <span>&bull;</span>
        <span>
          <b>Smoke state:</b> {{:smoke_alarm_state}}
        </span>
        <br>
        <span>
          <b>CO state:</b> {{:co_alarm_state}}
        </span>
        <span>&bull;</span>
        <span class="color-state"><b>Color state:</b>
          {{if ui_color_state === 'green'}}
            <img src="/img/green-state.png" />
          {{else ui_color_state === 'yellow'}}
            <img src="/img/yellow-state.png" />
          {{else ui_color_state === 'red'}}
            <img src="/img/red-state.png" />
          {{else}}
            <img src="/img/gray-state.png" />
          {{/if}}
        </span>
      </div>
    </div>
  </div>
</script>

<!-- Template for rendering NestCam state -->
<script id="cameraTemplate" type="text/x-jsrender">
  <div class="mdl-cell mdl-cell--4-col">
    <div class="mdl-card mdl-shadow--2dp demo-card-square">
      <div class="mdl-card__title mdl-card--expand" style="{{if last_event}}background: url('{{:last_event.animated_image_url}}') center / cover;{{/if}}">
        <h2 class="mdl-card__title-text">{{:name_long}}</h2>
      </div>
      <div class="mdl-card__supporting-text">
        <span>
          <b>Online:</b>{{if is_online}} Yes {{else}} No {{/if}}
        </span>
        <span>&bull;</span>
        <span>
          <b>Streaming:</b>{{if is_streaming}} Yes {{else}} No {{/if}}
        </span>
        <span>&bull;</span>
        <span>
          <b>Audio:</b>{{if is_audio_input_enabled}} Yes {{else}} No {{/if}}
        </span>
      </div>
    </div>
  </div>
</script>

<!-- Template for rendering each structure (and all devices) -->
<script id="structureTemplate" type="text/x-jsrender">
  <div class="demo-grid-1 mdl-grid">
    <h2 class="mdl-typography--display-3">
      {{:name}}
      <div class="typo-styles__demo mdl-typography--title home-away">Home/Away: {{:away}}</div>
    </h2>
    <br>
    {{for thermostats tmpl="#thermTemplate" /}}
    {{for smokeAlarms tmpl="#smokeTemplate" /}}
    {{for cameras tmpl="#cameraTemplate" /}}
  </div>
</script>

